<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Labwindows.Tutorial.Chapter 2 &#8211; Lyfing.Loo's Blog</title>
<meta name="description" content="Yet another guy dreams for landing on the moon someday">
<meta name="keywords" content="Tech, C, Labwindows Tutorial">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Labwindows.Tutorial.Chapter 2">
<meta property="og:description" content="Yet another guy dreams for landing on the moon someday">
<meta property="og:url" content="http://localhost:4000/2013/07/10/Labwindows-tutorial-chapter2.html">
<meta property="og:site_name" content="Lyfing.Loo's Blog">





<link rel="canonical" href="http://localhost:4000/2013/07/10/Labwindows-tutorial-chapter2.html">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Lyfing.Loo's Blog Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.min.css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">




<style type="text/css">body {background-image:url(http://localhost:4000/images/ps_neutral.png);}</style>


</head>

<body id="post"  itemscope itemtype="http://schema.org/WebPage">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation" itemscope itemtype="http://schema.org/SiteNavigationElement">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://localhost:4000">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://localhost:4000/images/avatar.jpg" alt="Lyfing.Loo photo" class="author-photo">
					<h4>Lyfing.Loo</h4>
					<p>Hangzhou, China</p>
				</li>
				<li><a href="http://localhost:4000/about/">Learn More</a></li>
				<li>
					<a href="mailto:hellolyfing@gmail.com"><i class="icon-envelope"></i> Email</a>
				</li>
				
				
				
				
				
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://localhost:4000/archive/">All Posts</a></li>
				<li><a href="http://localhost:4000/tags/">All Tags</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->




<div id="main" role="main" itemprop="mainContentOfPage" itemscope itemtype="http://schema.org/Blog">
  <article class="hentry" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title" itemprop="name"><a href="http://localhost:4000/2013/07/10/Labwindows-tutorial-chapter2.html" rel="bookmark" title="Labwindows.Tutorial.Chapter 2" itemprop="url">Labwindows.Tutorial.Chapter 2</a></h1>
        
        <h2>July 10, 2013</h2>
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content" itemprop="description">
      <p>导语：本篇文章将向大家演示如何在<strong>主Panel上</strong>创建一个<strong>Graph控件</strong>(Object)和两个<strong>按钮</strong>，并为这两个按钮绑定事件回调函数：  </p>

<ul>
  <li>点下<strong>按钮1</strong>，Graph控件显示Sine波形；  </li>
  <li>点下<strong>按钮2</strong>，Graph控件显示Cosine波形。</li>
</ul>

<p>效果如下图所示：  </p>

<!--more-->

<p><img src="http://ww3.sinaimg.cn/large/6480dca9tw1e66pudgy7aj20ej0l6abp.jpg" alt="" /></p>

<hr />

<p>LabWindows/CVI为开发者提供了三种类型的图表控件，在界面编辑器下，他们的创建方式为：<br />
在主面板上右击，在弹出的控件列表中，依次选择</p>

<ul>
  <li><strong>Graph</strong> » <strong>Graph</strong> 即可在主面板上新建一个Graph </li>
  <li><strong>Graph</strong> » <strong>Strip Chart</strong> 即可在主面板上新建一个Strip Chart </li>
  <li><strong>Graph</strong> » <strong>Digital Graph</strong> 即可在主面板上新建一个Digital Graph </li>
</ul>

<p>这里简单<strong>介绍一下</strong> LabWindows/CVI提供的<strong>三种Graph图表</strong>的功能和特点：</p>

<ul>
  <li>Graph：一般用于显示一个或多个<strong>静态</strong>图表。图表可由<strong>一个曲线</strong>、 <strong>一个点</strong>、 <strong>一个几何形状</strong>、 <strong>一张图片</strong>或 <strong>一个字符串</strong>组成 </li>
  <li>Strip Chart：一般用于<strong>动态显示实时数据</strong>，它可同时显示一路或多路信号。例如我的毕设是信号采集系统，采集到的信号都是实时变化的，这时候用Strip Chart是最好的选择 </li>
  <li>Digital Graph：顾名思义，它用于显示<strong>数字信号</strong>，显示内容其实就是一系列的<strong>方波</strong> </li>
</ul>

<hr />

<p>虽然上面介绍了三种图表控件，但鉴于本教程只为帮助初学者入门，所以此处只简单介绍三个图表控件中<strong>Graph控件</strong>的使用方法，至于其他两个图表控件的使用方法，可在掌握Graph用法后自行查找资料(官方的帮助文档及在线论坛)进行学习。</p>

<p>OK,here we go !</p>

<hr />

<p>1) 打开LabWindows/CVI，新建一个<strong>.uir</strong>文件；</p>

<p>2) 双击创建出来的面板，在面板的<strong>属性编辑框</strong>里，设置主面板的标题(Panel title:)为：<em>Using Graph Demo</em></p>

<p>3) 在面板上创建三个按钮(Command Button，创建方法见第一篇教程HelloWorld)<br />
双击<strong>第一个</strong>按钮，在弹出的按钮<strong>属性编辑框</strong>里，把<strong>Callback function</strong>的值设为 <em>showSineWave</em> | 把<strong>Label</strong>的值设为 <em>Sine</em><br />
之后点击OK(确定)回到主面板<br />
按上述方法，设置<strong>第二个</strong>按钮的<strong>Callback function</strong>的值为 <em>showCosineWave</em> | <strong>Label</strong>的值为 <em>Cosine</em><br />
接着设置<strong>第三个</strong>按钮的<strong>Callback function</strong>的值为 <em>quitSystem</em> | <strong>Label</strong>的值为 <em>Quit</em></p>

<p>4) 在面板上创建一个Graph控件。具体方法是：对着面板右击，在弹出的控件列表里，依次选择<strong>Graph</strong> » <strong>Graph</strong>(读者可用鼠标随意调整按钮和图表的位置及大小)<br />
目前为止，我们做出来的东西效果如下图所示<br />
<img src="http://ww2.sinaimg.cn/large/6480dca9tw1e66pscg411j20ec0a7wfb.jpg" alt="" /></p>

<p>5) 双击新建的Graph控件，在弹出的Graph<strong>属性编辑框</strong>里，在<strong>Label Appearance</strong>区域，设置<strong>Label</strong>的值为 <em>Graph Demo</em><br />
之后点击OK(确定)回到主面板</p>

<hr />

<p>好的，我们所有的界面编辑工作已经完成了，接下来，我们要做的就是编写程序，实现文章开头说到的那些功能了</p>

<p>1) 生成源代码文件，即<strong>.c</strong>文件<br />
操作步骤：依次点击系统菜单栏 <strong>Code</strong> » <strong>Generate</strong> » <strong>All code</strong><br />
操作图示：<br />
<img src="http://ww1.sinaimg.cn/large/6480dca9tw1e66pyn5o90j20cf09f75c.jpg" alt="" /><br />
此时<strong>系统提示</strong>需要首先保存<strong>.uir</strong>文件，将<strong>.uir</strong>文件命名为 <em>2-Using-Graph-Demo.uir</em>，接着新建文件夹<strong>2</strong>，把该<strong>.uir</strong>文件保存到新建的文件夹下<br />
(PS:为什么要新建文件夹并把.uir文件保存到这里？因为之后的<strong>.c</strong>代码文件以及包含此工程信息的<strong>所有文件</strong>后续都会保存到这个文件夹下，便于我们进行工程管理，也不会使电脑硬盘显得太乱)</p>

<p>2) 接下来，系统又会提示需要指定一个<strong>.c</strong>的源文件，依次点<strong>Yes</strong>、 <strong>OK</strong>新建<strong>.c</strong>文件</p>

<p>3) 此时会弹出<strong>Generate All Code</strong>窗口，各项设置及意义如下图所示(可右键查看大图)，之后点击<strong>OK</strong><br />
<img src="http://ww3.sinaimg.cn/large/6480dca9tw1e66qc4donfj20d20ep0uz.jpg" alt="" /></p>

<p>4) 在弹出的<strong>New Project Options</strong>窗口<br />
将<strong>Project Location</strong>设置为 <em>Create Project in Current Workspace</em><br />
在<strong>Transfer Project Options</strong>区域，把四个复选框都勾选上(默认就是全部勾选)<br />
之后点击<strong>OK</strong></p>

<p>5) 好吧，我们的源代码文件终于出现了。现贴出所有代码并注释:  </p>

<pre><code>#include &lt;cvirte.h&gt;;
#include &lt;userint.h&gt;;
#include "2-Using-Graph-Demo.h";

/* panelHandle是主面板的Handle
就相当于一个"对象索引";
我们知道，主面板、按钮、图表控件等等界面元素，在系统内存中都是以
一个内存块的形式存在的（在C++、Java里就是"对象"的概念）
当我们需要使用这些对象时，就是通过这个&amp;quot;索引&amp;quot;来指向这些对象的 */
static int panelHandle;

/* main函数入口，也是系统总入口 */
int main (int argc, char *argv[]) {
    if (InitCVIRTE (0, argv, 0) == 0)
        return -1;    /* out of memory */
    // LoadPanel()函数是LabWindows/CVI提供的系统函数
    // 如果想查看某个函数的介绍及参数等详情，可以把光标放到该函数上，然后按"F1"，
    // 这将会打开帮助文档中该函数的详细介绍
    if ((panelHandle = LoadPanel(0, "2-Using-Graph-Demo.uir", PANEL)) &lt;= 0)
        return -1;
    // LoadPanel()之后，需要DisplayPanel()函数来真正把载入的面板数据显示出来
    DisplayPanel (panelHandle);
    RunUserInterface ();
    DiscardPanel (panelHandle);
    return 0;
}

/* Sine按钮的回调函数
event事件包含了所有用户产生的事件，
如键盘事件，鼠标事件(左键单双击、右键单双击等等)，获得焦点、失去焦点事件等等 */
int CVICALLBACK showSineWave (int panel, int control, int event,
        void *callbackData, int eventData1, int eventData2) {
    switch (event) {
        case EVENT_COMMIT:

            break;
    }
    return 0;
}  
/* Cosine按钮的回调函数 */
int CVICALLBACK showCosineWave (int panel, int control, int event,
        void *callbackData, int eventData1, int eventData2) {
    switch (event) {
        case EVENT_COMMIT:

            break;
    }
    return 0;
}  
/* Quit按钮的回调函数 */
int CVICALLBACK quitSystem (int panel, int control, int event,
        void *callbackData, int eventData1, int eventData2) {
    switch (event) {
        case EVENT_COMMIT:
            //退出用户界面(退出按钮)
            QuitUserInterface (0);
            break;
    }
    return 0;
}
</code></pre>

<p>6) 编写<strong>Sine</strong>按钮的回调函数<br />
函数实现为：点击<strong>Sine</strong>按钮后，清空Graph控件上的所有图表内容，然后使用系统提供的<em>SinePattern()</em>函数生成一组Sine曲线的Y坐标值，最后通过描出Y坐标值来在Graph图表上汇出一个<strong>Sine</strong>曲线<br />
下面贴上该回调函数具体代码并注释：  </p>

<pre><code>int CVICALLBACK showSineWave (int panel, int control, int event,
        void *callbackData, int eventData1, int eventData2) {
    switch(event){
        //case是各种用户事件，到此查看所有事件列表
        // http://t.cn/zQ7jw42
        case EVENT_COMMIT:
            //删除Graph上的某个或所有图像(Plot),可把光标放置到函数名上，按F1查看帮助
            DeleteGraphPlot(panelHandle, PANEL_GRAPH, -1, VAL_IMMEDIATE_DRAW);
            //waveData[]数组用来保存SinePattern函数生成的100个Y坐标值
            double waveData[100], amp, phase, cycles;
            int n;
            n = 100;
            amp = 90.0;
            phase = 0.0;
            cycles = 1.5;
            //该步将生成100个Sine函数的Y坐标点，并将这些值保存到waveData数组里
            SinePattern(n, amp, phase, cycles, waveData);
            //该步把Y坐标值绘制到Graph图表控件中去
            PlotY(panelHandle, PANEL_GRAPH, waveData, n, VAL_DOUBLE, VAL_THIN_LINE, 
                  VAL_EMPTY_SQUARE, VAL_SOLID, VAL_CONNECTED_POINTS , VAL_YELLOW);
            break;
    }
    return 0;
}
</code></pre>

<p>7) 编写<strong>Cosine</strong>按钮的回调函数并注释  </p>

<pre><code>int CVICALLBACK showCosineWave(int panel, int control, int event,
        void *callbackData, int eventData1, int eventData2) {
    switch (event){
        case EVENT_COMMIT:
            DeleteGraphPlot(panelHandle, PANEL_GRAPH, -1, VAL_IMMEDIATE_DRAW);
            
            double waveData[100], amp, phase, cycles;
            int n;
            n = 100;
            amp = 90.0;
            //和Sine函数不同，此处相位应为90(度)
            phase = 90.0;
            cycles = 1.5;
            SinePattern(n, amp, phase, cycles, waveData);
            
            PlotY(panelHandle, PANEL_GRAPH, waveData, n, VAL_DOUBLE, VAL_THIN_LINE, 
                  VAL_EMPTY_SQUARE, VAL_SOLID, VAL_CONNECTED_POINTS , VAL_YELLOW);
            break;
    }
    return 0;
}
</code></pre>

<hr />

<p>好的，至此两个按钮的回调函数都已经完成。下面需要开始<strong>试运行(Debug程序)</strong><br />
有两种方法<strong>试运行</strong>程序</p>

<ul>
  <li>通过工具栏的<strong>红色播放按钮</strong>试运行</li>
  <li>通过菜单栏的<strong>Run</strong> » <strong>Debug 2-Using-Graph-Demo.exe</strong>选项来试运行程序<br />
具体操作如下图所示：<br />
<img src="http://ww2.sinaimg.cn/large/6480dca9tw1e66qebhm8wj20b009ojsh.jpg" alt="" /> </li>
</ul>

<p>运行结果:<br />
<img src="http://ww3.sinaimg.cn/large/6480dca9tw1e66pudgy7aj20ej0l6abp.jpg" alt="" /></p>

<hr />

<p>程序源码<a href="https://github.com/HelloLyfing/LabWindows-CVI-Tutorial-For-Newbie-By.Lyfing">托管在Github</a>上，请自行前往查看。</p>


      <footer class="entry-meta">
        <span class="entry-tags"><a href="http://localhost:4000/tags/index.html#Tech" title="Pages tagged Tech" rel="tag" class="tag">Tech</a><a href="http://localhost:4000/tags/index.html#C" title="Pages tagged C" rel="tag" class="tag">C</a><a href="http://localhost:4000/tags/index.html#Labwindows Tutorial" title="Pages tagged Labwindows Tutorial" rel="tag" class="tag">Labwindows Tutorial</a></span>
        <span><a href="http://localhost:4000/2013/07/10/Labwindows-tutorial-chapter2.html" rel="bookmark" title="Labwindows.Tutorial.Chapter 2" itemprop="url">Labwindows.Tutorial.Chapter 2</a> was published on <span class="entry-date date published updated"><time datetime="2013-07-10T00:00:00+08:00" itemprop="datePublished">July 10, 2013</time></span></span>
        (revised: <span class="entry-date date modified"><time datetime="2013-07-18 5:00" itemprop="dateModified">07/18/2013</time></span>)
        <span class="author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name" class="fn"><a href="http://localhost:4000/about" title="About Lyfing.Loo" itemprop="url">Lyfing.Loo</a></span></span>
        
      </footer>
    </div><!-- /.entry-content -->
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
    
    <div class="read-more">
      
        <div class="read-more-header">
          <a href="http://localhost:4000/2013/06/28/Labwindows-tutorial-chapter1.html" class="read-more-btn">Read More</a>
        </div><!-- /.read-more-header -->
        <div class="read-more-content">
          <h3><a href="http://localhost:4000/2014/06/28/upload-browser-cached-image-by-using-xhr.html" title="通过XHR上传浏览器缓存的图片资源">通过XHR上传浏览器缓存的图片资源</a></h3>
          <p>通过发起XHR请求的方式获取浏览器缓存的图片资源 <a href="http://localhost:4000/2014/06/28/upload-browser-cached-image-by-using-xhr.html">Continue reading</a></p>
        </div><!-- /.read-more-content -->
      
      <div class="read-more-list">
        
          <div class="list-item">
            <h4><a href="http://localhost:4000/2014/01/12/Python-a-web-spider-for-fetching-qiubai-articles.html" title="Python爬虫 实现从糗百上多线程抓取内容">Python爬虫 实现从糗百上多线程抓取内容</a></h4>
            <span>Published on January 12, 2014</span>
          </div><!-- /.list-item -->
        
          <div class="list-item">
            <h4><a href="http://localhost:4000/2014/01/09/study-on-python-unicode-encoding-stuff.html" title="关于Python的编码、乱码以及Unicode的一些研究">关于Python的编码、乱码以及Unicode的一些研究</a></h4>
            <span>Published on January 09, 2014</span>
          </div><!-- /.list-item -->
        
      </div><!-- /.read-more-list -->
      
    </div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2014 Lyfing.Loo. Powered by <a href="http://jekyllrb.com">Jekyll</a> hosted on Github Pages using the <a href="https://github.com/mmistakes/hpstr-jekyll-theme">HPSTR Theme</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->

<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"></script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'lyfing521'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	        

</body>
</html>
